<div class="flex flex-col items-center mt-10">
  <span class="text-xl font-bold mb-4">Ostavite komentar</span>
  <textarea class="textarea textarea-bordered w-2/5 mb-5" placeholder="..." [(ngModel)]="newCommentValue"></textarea>
  <button class="btn btn-primary" (click)="handleAddCommentClick()">
    Dodaj komentar
  </button>
  <div class="flex flex-col-reverse mt-10 w-2/5 justify-evenly items-center">
    @for (comment of comments; track comment.id) {
      <div class="flex flex-col mb-8 w-full justify-between bg-sky-100 rounded-xl text-base-100 p-6">
        <div class="flex mb-4 w-full">
          <div class="btn btn-ghost btn-circle avatar pointer-events-none">
            <div class="w-10 rounded-full">
              @if (comment.userProfileImageUrl) {
                <img [src]="comment.userProfileImageUrl" class="max-w-12">
              } @else {
                <img src="/assets/default_avatar.png" class="max-w-12">
              }
            </div>
          </div>
          <div class="flex ml-4 justify-between w-full">
            <span class="self-center">{{comment.userUsername}}</span>
            @if (comment.isEdited) {
              <span class="italic font-thin text-sm self-center">edited</span>
            }
            @if (comment.userUsername === currentUsername()) {
              <div class="flex items-center">
                <svg class="mr-5 disabled-svg" fill="#000000" height="32px" width="32px" version="1.1" id="svg-icon-{{comment.id}}" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
                     viewBox="0 0 512 512" xml:space="preserve" (click)="save(comment.id)">
                  <g>
                    <g>
                      <path d="M440.125,0H0v512h512V71.875L440.125,0z M281.6,31.347h31.347v94.041H281.6V31.347z M136.359,31.347h113.894v125.388
                        h94.041V31.347h32.392v156.735H136.359V31.347z M417.959,480.653H94.041V344.816h323.918V480.653z M417.959,313.469H94.041
                        v-31.347h323.918V313.469z M480.653,480.653h-31.347V250.775H62.694v229.878H31.347V31.347h73.665v188.082h303.02V31.347h19.108
                        l53.512,53.512V480.653z"/>
                    </g>
                  </g>
                </svg>
                <svg fill="#000000" height="32px" width="32px" version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
                     viewBox="0 0 60.167 60.167" xml:space="preserve" class="cursor-pointer" (click)="deleteComment(comment.id)">
                <path d="M54.5,11.667H39.88V3.91c0-2.156-1.754-3.91-3.91-3.91H24.196c-2.156,0-3.91,1.754-3.91,3.91v7.756H5.667
                  c-0.552,0-1,0.448-1,1s0.448,1,1,1h2.042v40.5c0,3.309,2.691,6,6,6h32.75c3.309,0,6-2.691,6-6v-40.5H54.5c0.552,0,1-0.448,1-1
                  S55.052,11.667,54.5,11.667z M22.286,3.91c0-1.053,0.857-1.91,1.91-1.91H35.97c1.053,0,1.91,0.857,1.91,1.91v7.756H22.286V3.91z
                   M50.458,54.167c0,2.206-1.794,4-4,4h-32.75c-2.206,0-4-1.794-4-4v-40.5h40.75V54.167z M38.255,46.153V22.847c0-0.552,0.448-1,1-1
                  s1,0.448,1,1v23.306c0,0.552-0.448,1-1,1S38.255,46.706,38.255,46.153z M29.083,46.153V22.847c0-0.552,0.448-1,1-1s1,0.448,1,1
                  v23.306c0,0.552-0.448,1-1,1S29.083,46.706,29.083,46.153z M19.911,46.153V22.847c0-0.552,0.448-1,1-1s1,0.448,1,1v23.306
                  c0,0.552-0.448,1-1,1S19.911,46.706,19.911,46.153z"/>
                </svg>
              </div>
            }
          </div>
        </div>
        <textarea class="textarea textarea-bordered text-gray-300" (input)="onTextInput(comment.id, $event)" [value]="comment.text" [readonly]="comment.userUsername !== currentUsername()"></textarea>
      </div>
    }
  </div>
</div>
